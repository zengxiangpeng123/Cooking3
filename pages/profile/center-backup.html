<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”¨æˆ·ä¸­å¿ƒ - ç‚’èœå­¦ä¹ å¹³å°</title>
    <meta name="description" content="ç®¡ç†æ‚¨çš„ä¸ªäººä¿¡æ¯ã€å­¦ä¹ è¿›åº¦å’Œè´¦æˆ·è®¾ç½®">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="../../data/imgs/å›¾æ ‡.iconfont">
    <link rel="shortcut icon" type="image/x-icon" href="../../data/imgs/å›¾æ ‡.iconfont">
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- CSS æ ·å¼æ–‡ä»¶ -->
    <link rel="stylesheet" href="../../css/base/reset.css">
    <link rel="stylesheet" href="../../css/base/variables.css">
    <link rel="stylesheet" href="../../css/base/base.css">
    <link rel="stylesheet" href="../../css/components/header.css">
    <link rel="stylesheet" href="../../css/components/footer.css">
    <link rel="stylesheet" href="../../css/components/card.css">
    <link rel="stylesheet" href="../../css/pages/profile.css">
    <link rel="stylesheet" href="../../css/responsive.css">
    
    <!-- ç”¨æˆ·ä¸­å¿ƒå¢å¼ºæ ·å¼ -->
    <style>
        /* ç»Ÿè®¡å¡ç‰‡å›¾æ ‡æ ·å¼ */
        .stats__icon img {
            width: 48px;
            height: 48px;
            object-fit: contain;
        }
        
        /* æœ€è¿‘å­¦ä¹ ç½‘æ ¼ */
        .recent-learning__grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        /* å­¦ä¹ è®°å½•å¡ç‰‡ */
        .learning-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            overflow: hidden;
            transition: transform 0.3s, box-shadow 0.3s;
            position: relative;
            cursor: pointer;
        }
        
        .learning-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        
        .learning-card__image {
            position: relative;
            height: 160px;
            overflow: hidden;
        }
        
        /* æœ¬å‘¨å­¦ä¹ æ ·å¼å¢å¼º */
        .weekly__grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 12px;
            margin: 20px 0;
        }
        
        .day__item {
            text-align: center;
            padding: 15px 8px;
            border-radius: 12px;
            transition: all 0.3s;
            position: relative;
            min-height: 100px;
        }
        
        .day__item.completed {
            background: linear-gradient(135deg, #4caf50, #45a049);
            color: white;
            transform: scale(1.02);
        }
        
        .day__item.current {
            background: linear-gradient(135deg, #ff6b35, #ff8b5a);
            color: white;
            transform: scale(1.05);
            box-shadow: 0 4px 15px rgba(255, 107, 53, 0.4);
        }
        
        .day__item.missed {
            background: linear-gradient(135deg, #f44336, #d32f2f);
            color: white;
        }
        
        .day__item.future {
            background: #f8f9fa;
            color: #666;
            border: 2px dashed #ddd;
        }
        
        .day__name {
            font-size: 0.85rem;
            font-weight: 600;
            display: block;
        }
        
        .day__status {
            font-size: 1.5rem;
            margin: 8px 0;
        }
        
        .day__date {
            font-size: 0.75rem;
            opacity: 0.8;
        }
        
        .day__count {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(255,255,255,0.3);
            color: inherit;
            font-size: 0.7rem;
            padding: 2px 6px;
            border-radius: 10px;
        }
        
        /* å‘¨æ€»ç»“æ ·å¼ */
        .weekly__summary {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .summary__item {
            font-size: 0.9rem;
            color: #666;
        }
        
        .week-range {
            font-size: 0.85rem;
            color: #666;
            font-weight: normal;
        }
        
        /* ç”¨æˆ·ä¸­å¿ƒå¸ƒå±€ä¿®å¤ - å·¦ä¾§è¾¹æ ç‹¬ç«‹æ»šåŠ¨ */
        .center__content {
            display: flex;
            gap: 30px;
            align-items: flex-start; /* é‡è¦ï¼šé¡¶éƒ¨å¯¹é½ */
            max-height: calc(100vh - 200px); /* é™åˆ¶æ€»é«˜åº¦ */
        }
        
        .center__sidebar {
            flex: 0 0 280px;
            position: sticky;
            top: 120px; /* ç²˜æ€§å®šä½ï¼Œç›¸å¯¹äºå¤´éƒ¨ */
            max-height: calc(100vh - 140px); /* æœ€å¤§é«˜åº¦ */
            overflow-y: auto; /* ç‹¬ç«‹æ»šåŠ¨æ¡ */
            padding-right: 10px; /* ä¸ºæ»šåŠ¨æ¡ç•™ç©ºé—´ */
        }
        
        .center__main {
            flex: 1;
            min-height: 0; /* å…è®¸å†…å®¹æ”¶ç¼© */
        }
        
        /* ç¾åŒ–æ»šåŠ¨æ¡ */
        .center__sidebar::-webkit-scrollbar {
            width: 6px;
        }
        
        .center__sidebar::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 3px;
        }
        
        .center__sidebar::-webkit-scrollbar-thumb {
            background: #ff6b35;
            border-radius: 3px;
        }
        
        .center__sidebar::-webkit-scrollbar-thumb:hover {
            background: #e55a2b;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .center__content {
                flex-direction: column;
                max-height: none;
            }
            
            .center__sidebar {
                flex: 1;
                position: static;
                max-height: none;
                overflow-y: visible;
                padding-right: 0;
            }
            
            .recent-learning__grid {
                grid-template-columns: 1fr;
            }
            
            .weekly__grid {
                grid-template-columns: repeat(7, 1fr);
                gap: 8px;
            }
            
            .day__item {
                padding: 10px 4px;
                min-height: 80px;
            }
            
            .day__name {
                font-size: 0.75rem;
            }
            
            .day__status {
                font-size: 1.2rem;
                margin: 4px 0;
            }
            
            .weekly__summary {
                flex-direction: column;
                gap: 10px;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <!-- é¡µé¢å¤´éƒ¨ -->
    <header class="header">
        <div class="container">
            <div class="header__content">
                <div class="header__logo">
                    <a href="../../main.html" class="logo">
                        <img src="../../data/imgs/å›¾æ ‡.png" alt="ç‚’èœå­¦ä¹ å¹³å°" class="logo__icon">
                        <span class="logo__text">ç‚’èœå­¦ä¹ å¹³å°</span>
                    </a>
                </div>
                
                <nav class="header__nav">
                    <ul class="nav__list">
                        <li class="nav__item">
                            <a href="../../main.html" class="nav__link">é¦–é¡µ</a>
                        </li>
                        <li class="nav__item">
                            <a href="../recipes/list.html" class="nav__link">èœè°±å¤§å…¨</a>
                        </li>
                        <li class="nav__item">
                            <a href="../guide/basics.html" class="nav__link">çƒ¹é¥ªæŒ‡å—</a>
                        </li>
                        <li class="nav__item">
                            <a href="../forum/index.html" class="nav__link">ç¾é£Ÿè®ºå›</a>
                        </li>
                        <li class="nav__item">
                            <a href="favorites.html" class="nav__link">æˆ‘çš„æ”¶è—</a>
                        </li>
                        <li class="nav__item">
                            <a href="center.html" class="nav__link nav__link--active">ç”¨æˆ·ä¸­å¿ƒ</a>
                        </li>
                    </ul>
                </nav>
                
                <div class="header__search">
                    <form class="search__form" id="searchForm">
                        <input type="text" class="search__input" placeholder="æœç´¢èœè°±æˆ–é£Ÿæ..." id="searchInput">
                        <button type="submit" class="search__btn">
                            <span class="search__icon">ğŸ”</span>
                        </button>
                    </form>
                </div>
                
                <button class="header__menu-btn" id="mobileMenuBtn">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
        </div>
    </header>

    <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
    <main class="main">
        <!-- ç”¨æˆ·ä¸­å¿ƒå†…å®¹ -->
        <section class="user-center">
            <div class="container">
                <h1 class="page__title">ç”¨æˆ·ä¸­å¿ƒ</h1>
                <div class="center__content">
                    <div class="center__sidebar">
                        <div class="user__profile-card">
                            <div class="profile__avatar-wrapper">
                                <div class="profile__avatar">
                                    <img src="../../assets/images/avatars/default.png" alt="ç”¨æˆ·å¤´åƒ" id="profileAvatar" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iODAiIHZpZXdCb3g9IjAgMCA4MCA4MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iNDAiIGN5PSI0MCIgcj0iNDAiIGZpbGw9IiNmZjZiMzUiLz4KPHN2ZyB4PSIyMCIgeT0iMjAiIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgZmlsbD0id2hpdGUiPgo8c3ZnIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDQwIDQwIiBmaWxsPSJub25lIj4KPHBhdGggZD0iTTIwIDIwQzI0IDIwIDI4IDE2IDI4IDE2QzI4IDEyIDI0IDggMjAgOEMxNiA4IDEyIDEyIDEyIDE2QzEyIDE2IDE2IDIwIDIwIDIwWiIgZmlsbD0iY3VycmVudENvbG9yIi8+CjxwYXRoIGQ9Ik0yMCAyNEMxNiAyNCA4IDI4IDggMzZDOCAzNiAxMiA0MCAyMCA0MEMyOCA0MCAzMiAzNiAzMiAzNkMzMiAyOCAyNCAyNCAyMCAyNFoiIGZpbGw9ImN1cnJlbnRDb2xvciIvPgo8L3N2Zz4KPC9zdmc+Cjwvc3ZnPgo='; this.style.border='3px solid #ff6b35'">
                                </div>
                                <button class="avatar__upload-btn" id="avatarUploadBtn" title="æ›´æ¢å¤´åƒ">
                                    <i class="fas fa-camera"></i>
                                </button>
                                <input type="file" id="avatarInput" accept="image/*" style="display: none;">
                            </div>
                            <div class="profile__info">
                                <h2 class="profile__name" id="profileName">ç”¨æˆ·å</h2>
                                <p class="profile__email" id="profileEmail">email@example.com</p>
                                <button class="profile__edit-btn" id="editProfileBtn">ç¼–è¾‘èµ„æ–™</button>
                            </div>
                        </div>
                        
                        <nav class="center__nav">
                            <a href="#profile" class="center__nav-item center__nav-item--active" data-section="profile">
                                <i class="fas fa-user"></i>
                                ä¸ªäººä¿¡æ¯
                            </a>
                            <a href="#learning" class="center__nav-item" data-section="learning">
                                <i class="fas fa-chart-line"></i>
                                å­¦ä¹ è¿›åº¦
                            </a>
                            <a href="favorites.html" class="center__nav-item">
                                <i class="fas fa-heart"></i>
                                æˆ‘çš„æ”¶è—
                            </a>
                            <a href="#security" class="center__nav-item" data-section="security">
                                <i class="fas fa-shield-alt"></i>
                                è´¦æˆ·å®‰å…¨
                            </a>
                            <a href="#notifications" class="center__nav-item" data-section="notifications">
                                <i class="fas fa-bell"></i>
                                é€šçŸ¥è®¾ç½®
                            </a>
                            <a href="#help" class="center__nav-item" data-section="help">
                                <i class="fas fa-question-circle"></i>
                                å¸®åŠ©ä¸­å¿ƒ
                            </a>
                        </nav>
                    </div>
                    
                    <div class="center__main">
                        <!-- ç»Ÿè®¡å¡ç‰‡ -->
                        <div class="stats__grid">
                            <div class="stats__card">
                                <div class="stats__icon">
                                    <img src="../../data/imgs/ç”¨æˆ·ä¸­å¿ƒ/å·²å­¦èœè°±.png" alt="å·²å­¦èœè°±" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                                    <div class="fallback-icon" style="display:none;">ğŸ“š</div>
                                </div>
                                <div class="stats__number" id="learnedRecipes">12</div>
                                <div class="stats__label">å·²å­¦èœè°±</div>
                            </div>
                            <div class="stats__card">
                                <div class="stats__icon">
                                    <img src="../../data/imgs/ç”¨æˆ·ä¸­å¿ƒ/æ”¶è—èœè°±.png" alt="æ”¶è—èœè°±" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                                    <div class="fallback-icon" style="display:none;">â¤ï¸</div>
                                </div>
                                <div class="stats__number" id="favoriteCount">8</div>
                                <div class="stats__label">æ”¶è—èœè°±</div>
                            </div>
                            <div class="stats__card">
                                <div class="stats__icon">
                                    <img src="../../data/imgs/ç”¨æˆ·ä¸­å¿ƒ/å­¦ä¹ å¤©æ•°.png" alt="å­¦ä¹ å¤©æ•°" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                                    <div class="fallback-icon" style="display:none;">ğŸ“…</div>
                                </div>
                                <div class="stats__number" id="studyDays">15</div>
                                <div class="stats__label">å­¦ä¹ å¤©æ•°</div>
                            </div>
                            <div class="stats__card">
                                <div class="stats__icon">
                                    <img src="../../data/imgs/ç”¨æˆ·ä¸­å¿ƒ/è·å¾—æˆå°±.png" alt="è·å¾—æˆå°±" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                                    <div class="fallback-icon" style="display:none;">ğŸ†</div>
                                </div>
                                <div class="stats__number" id="achievements">3</div>
                                <div class="stats__label">è·å¾—æˆå°±</div>
                            </div>
                        </div>

                        <!-- ä¸ªäººä¿¡æ¯ -->
                        <div class="center__section" id="profileSection">
                            <div class="section__header">
                                <h3 class="section__title">ä¸ªäººä¿¡æ¯</h3>
                                <button class="section__edit-btn" id="toggleEditMode">
                                    <i class="fas fa-edit"></i>
                                    ç¼–è¾‘èµ„æ–™
                                </button>
                            </div>
                            
                            <!-- æŸ¥çœ‹æ¨¡å¼ -->
                            <div class="info__view" id="profileView">
                                <div class="info__grid">
                                    <div class="info__item">
                                        <label>ç”¨æˆ·å</label>
                                        <span id="displayUsername">ç”¨æˆ·å</span>
                                    </div>
                                    <div class="info__item">
                                        <label>é‚®ç®±åœ°å€</label>
                                        <span id="displayEmail">email@example.com</span>
                                    </div>
                                    <div class="info__item">
                                        <label>æ‰‹æœºå·ç </label>
                                        <span id="displayPhone">æœªç»‘å®š</span>
                                    </div>
                                    <div class="info__item">
                                        <label>ä¸ªäººç®€ä»‹</label>
                                        <span id="displayBio">çƒ­çˆ±ç¾é£Ÿçš„çƒ¹é¥ªçˆ±å¥½è€…</span>
                                    </div>
                                    <div class="info__item">
                                        <label>æ³¨å†Œæ—¶é—´</label>
                                        <span>2024å¹´10æœˆ</span>
                                    </div>
                                    <div class="info__item">
                                        <label>æœ€åæ´»è·ƒ</label>
                                        <span>ä»Šå¤©</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- ç¼–è¾‘æ¨¡å¼ -->
                            <div class="info__edit" id="profileEdit" style="display: none;">
                                <form class="edit__form" id="profileEditForm">
                                    <div class="form__grid">
                                        <div class="form__group">
                                            <label for="editUsername" class="form__label">ç”¨æˆ·å</label>
                                            <input type="text" id="editUsername" class="form__input" placeholder="è¯·è¾“å…¥ç”¨æˆ·å">
                                        </div>
                                        <div class="form__group">
                                            <label for="editEmail" class="form__label">é‚®ç®±åœ°å€</label>
                                            <input type="email" id="editEmail" class="form__input" placeholder="è¯·è¾“å…¥é‚®ç®±">
                                        </div>
                                        <div class="form__group">
                                            <label for="editPhone" class="form__label">æ‰‹æœºå·ç </label>
                                            <input type="tel" id="editPhone" class="form__input" placeholder="è¯·è¾“å…¥æ‰‹æœºå·">
                                        </div>
                                        <div class="form__group form__group--full">
                                            <label for="editBio" class="form__label">ä¸ªäººç®€ä»‹</label>
                                            <textarea id="editBio" class="form__textarea" placeholder="ä»‹ç»ä¸€ä¸‹è‡ªå·±çš„çƒ¹é¥ªå…´è¶£..." rows="3"></textarea>
                                        </div>
                                    </div>
                                    <div class="form__actions">
                                        <button type="submit" class="btn btn--primary">
                                            <i class="fas fa-save"></i>
                                            ä¿å­˜ä¿®æ”¹
                                        </button>
                                        <button type="button" class="btn btn--secondary" id="cancelEditBtn">
                                            <i class="fas fa-times"></i>
                                            å–æ¶ˆ
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>

                        <!-- æœ€è¿‘å­¦ä¹  -->
                        <div class="center__section" id="learningSection">
                            <div class="section__header">
                                <h3 class="section__title">æœ€è¿‘å­¦ä¹ </h3>
                                <button class="section__edit-btn" onclick="clearLearningHistory()">
                                    <i class="fas fa-trash"></i>
                                    æ¸…ç©ºè®°å½•
                                </button>
                            </div>
                            
                            <!-- å­¦ä¹ å†å²ç½‘æ ¼ -->
                            <div class="recent-learning__grid" id="recentLearningGrid">
                                <!-- å­¦ä¹ å†å²å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                            </div>
                            
                            <!-- æŸ¥çœ‹æ›´å¤šæŒ‰é’® -->
                            <div class="section__actions" id="viewMoreLearning" style="text-align: center; margin-top: 20px; display: none;">
                                <button class="btn btn--outline" onclick="openFullLearningHistory()">
                                    <i class="fas fa-history"></i>
                                    æŸ¥çœ‹å…¨éƒ¨å­¦ä¹ è®°å½•
                                </button>
                            </div>
                            
                            <!-- ç©ºçŠ¶æ€ -->
                            <div class="learning-empty-state" id="learningEmptyState" style="display: none;">
                                <div class="empty-state__icon" style="font-size: 4rem;">ğŸ“š</div>
                                <h3 class="empty-state__title">è¿˜æ²¡æœ‰å­¦ä¹ è®°å½•</h3>
                                <p class="empty-state__description">
                                    æµè§ˆèœè°±è¯¦æƒ…é¡µå³ä¼šè‡ªåŠ¨è®°å½•å­¦ä¹ å†å²<br>
                                    å¿«å»èœè°±å¤§å…¨æ‰¾æ‰¾æ„Ÿå…´è¶£çš„èœè°±å§ï¼
                                </p>
                                <a href="../recipes/list.html" class="btn btn--primary">
                                    ğŸ³ å»å­¦ä¹ èœè°±
                                </a>
                            </div>
                        </div>

                        <!-- æˆå°±ç³»ç»Ÿ -->
                        <div class="center__section" id="achievementsSection">
                            <h3 class="section__title">æˆ‘çš„æˆå°±</h3>
                            <div class="achievements__grid">
                                <div class="achievement-card achievement-card--unlocked">
                                    <div class="achievement-card__icon">ğŸ–ï¸</div>
                                    <h4 class="achievement-card__title">åˆå­¦è€…</h4>
                                    <p class="achievement-card__description">å®Œæˆç¬¬ä¸€ä¸ªèœè°±å­¦ä¹ </p>
                                    <div class="achievement-card__progress">
                                        <div class="achievement-card__progress-bar" style="width: 100%;"></div>
                                    </div>
                                    <div class="achievement-card__progress-text">å·²è§£é”</div>
                                </div>
                                
                                <div class="achievement-card achievement-card--unlocked">
                                    <div class="achievement-card__icon">ğŸ”¥</div>
                                    <h4 class="achievement-card__title">çƒ­çˆ±çƒ¹é¥ª</h4>
                                    <p class="achievement-card__description">è¿ç»­å­¦ä¹ 7å¤©</p>
                                    <div class="achievement-card__progress">
                                        <div class="achievement-card__progress-bar" style="width: 100%;"></div>
                                    </div>
                                    <div class="achievement-card__progress-text">å·²è§£é”</div>
                                </div>
                                
                                <div class="achievement-card achievement-card--locked">
                                    <div class="achievement-card__icon">ğŸ‘¨â€ğŸ³</div>
                                    <h4 class="achievement-card__title">å¨è‰ºå¤§å¸ˆ</h4>
                                    <p class="achievement-card__description">å­¦ä¼š50ä¸ªèœè°±</p>
                                    <div class="achievement-card__progress">
                                        <div class="achievement-card__progress-bar" style="width: 24%;"></div>
                                    </div>
                                    <div class="achievement-card__progress-text">12/50</div>
                                </div>
                                
                                <div class="achievement-card achievement-card--locked">
                                    <div class="achievement-card__icon">ğŸŒŸ</div>
                                    <h4 class="achievement-card__title">ç¾é£Ÿä¸“å®¶</h4>
                                    <p class="achievement-card__description">æ”¶è—100ä¸ªèœè°±</p>
                                    <div class="achievement-card__progress">
                                        <div class="achievement-card__progress-bar" style="width: 8%;"></div>
                                    </div>
                                    <div class="achievement-card__progress-text">8/100</div>
                                </div>
                            </div>
                        </div>

                        <!-- æ•°æ®ç®¡ç† -->
                        <div class="center__section" id="dataSection">
                            <h3 class="section__title">æ•°æ®ç®¡ç†</h3>
                            <div class="data__grid">
                                <div class="data__card">
                                    <div class="data__header">
                                        <div class="data__icon">ğŸ“Š</div>
                                        <div class="data__info">
                                            <h4 class="data__title">å­¦ä¹ æ•°æ®åŒæ­¥</h4>
                                            <p class="data__desc">åŒæ­¥æ‚¨çš„å­¦ä¹ è¿›åº¦å’Œæˆå°±</p>
                                        </div>
                                    </div>
                                    <button class="data__action" onclick="syncLearningData()">
                                        <i class="fas fa-sync"></i>
                                        åŒæ­¥æ•°æ®
                                    </button>
                                </div>
                                
                                <div class="data__card">
                                    <div class="data__header">
                                        <div class="data__icon">ğŸ’¾</div>
                                        <div class="data__info">
                                            <h4 class="data__title">æ”¶è—ç®¡ç†</h4>
                                            <p class="data__desc">å¯¼å…¥å¯¼å‡ºæ”¶è—çš„èœè°±æ•°æ®</p>
                                        </div>
                                    </div>
                                    <div class="data__actions">
                                        <button class="data__action" onclick="exportFavorites()">
                                            <i class="fas fa-download"></i>
                                            å¯¼å‡ºæ”¶è—
                                        </button>
                                        <button class="data__action" onclick="importFavorites()">
                                            <i class="fas fa-upload"></i>
                                            å¯¼å…¥æ”¶è—
                                        </button>
                                        <button class="data__action" onclick="clearFavorites()">
                                            <i class="fas fa-trash"></i>
                                            æ¸…ç©ºæ”¶è—
                                        </button>
                                    </div>
                                    <input type="file" id="favoritesFileInput" accept=".json" style="display: none;">
                                </div>
                                
                                <div class="data__card">
                                    <div class="data__header">
                                        <div class="data__icon">ğŸ”„</div>
                                        <div class="data__info">
                                            <h4 class="data__title">æ•°æ®å¤‡ä»½</h4>
                                            <p class="data__desc">å¤‡ä»½æ¢å¤æ‰€æœ‰ä¸ªäººæ•°æ®</p>
                                        </div>
                                    </div>
                                    <div class="data__actions">
                                        <button class="data__action" onclick="backupAllData()">
                                            <i class="fas fa-download"></i>
                                            å¤‡ä»½æ•°æ®
                                        </button>
                                        <button class="data__action" onclick="importAllData()">
                                            <i class="fas fa-upload"></i>
                                            æ¢å¤æ•°æ®
                                        </button>
                                    </div>
                                    <input type="file" id="backupFileInput" accept=".json" style="display: none;">
                                </div>
                            </div>
                        </div>

                        <!-- è´¦æˆ·å®‰å…¨ -->
                        <div class="center__section" id="securitySection" style="display: none;">
                            <h3 class="section__title">è´¦æˆ·å®‰å…¨</h3>
                            <div class="security__grid">
                                <div class="security__card">
                                    <div class="security__header">
                                        <div class="security__icon">ğŸ”’</div>
                                        <div class="security__info">
                                            <h4 class="security__title">å¯†ç ä¿®æ”¹</h4>
                                            <p class="security__desc">å®šæœŸæ›´æ–°å¯†ç ä¿æŠ¤è´¦æˆ·å®‰å…¨</p>
                                        </div>
                                    </div>
                                    <button class="security__action" onclick="showPasswordModal()">
                                        <i class="fas fa-key"></i>
                                        ä¿®æ”¹å¯†ç 
                                    </button>
                                </div>
                                
                                <div class="security__card">
                                    <div class="security__header">
                                        <div class="security__icon">ğŸ“±</div>
                                        <div class="security__info">
                                            <h4 class="security__title">äºŒæ­¥éªŒè¯</h4>
                                            <p class="security__desc">ç»‘å®šæ‰‹æœºå·ç è¿›è¡Œå®‰å…¨éªŒè¯</p>
                                        </div>
                                    </div>
                                    <div class="security__toggle">
                                        <label class="toggle__label">
                                            <input type="checkbox" id="twoFactorToggle">
                                            <span class="toggle__switch"></span>
                                            <span class="toggle__text">å¯ç”¨éªŒè¯</span>
                                        </label>
                                    </div>
                                </div>
                                
                                <div class="security__card">
                                    <div class="security__header">
                                        <div class="security__icon">ğŸ”</div>
                                        <div class="security__info">
                                            <h4 class="security__title">ç™»å½•è®¾å¤‡</h4>
                                            <p class="security__desc">ç®¡ç†å·²ç™»å½•çš„è®¾å¤‡</p>
                                        </div>
                                    </div>
                                    <button class="security__action" onclick="showDevices()">
                                        <i class="fas fa-laptop"></i>
                                        æŸ¥çœ‹è®¾å¤‡
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- é€šçŸ¥è®¾ç½® -->
                        <div class="center__section" id="notificationsSection" style="display: none;">
                            <h3 class="section__title">é€šçŸ¥è®¾ç½®</h3>
                            <div class="notifications__list">
                                <div class="notification__item">
                                    <div class="notification__info">
                                        <h4 class="notification__title">æ–°èœè°±æ¨è</h4>
                                        <p class="notification__desc">å½“æœ‰æ–°èœè°±æ›´æ–°æ—¶é€šçŸ¥æˆ‘</p>
                                    </div>
                                    <label class="toggle__label">
                                        <input type="checkbox" id="recipeNotifications" checked>
                                        <span class="toggle__switch"></span>
                                    </label>
                                </div>
                                
                                <div class="notification__item">
                                    <div class="notification__info">
                                        <h4 class="notification__title">è®ºå›æ¶ˆæ¯</h4>
                                        <p class="notification__desc">æ”¶åˆ°è®ºå›å›å¤å’Œç§ä¿¡æ—¶é€šçŸ¥</p>
                                    </div>
                                    <label class="toggle__label">
                                        <input type="checkbox" id="forumNotifications" checked>
                                        <span class="toggle__switch"></span>
                                    </label>
                                </div>
                                
                                <div class="notification__item">
                                    <div class="notification__info">
                                        <h4 class="notification__title">å­¦ä¹ æé†’</h4>
                                        <p class="notification__desc">æ¯æ—¥å­¦ä¹ æé†’</p>
                                    </div>
                                    <label class="toggle__label">
                                        <input type="checkbox" id="studyReminder">
                                        <span class="toggle__switch"></span>
                                    </label>
                                </div>
                                
                                <div class="notification__item">
                                    <div class="notification__info">
                                        <h4 class="notification__title">é‚®ä»¶é€šçŸ¥</h4>
                                        <p class="notification__desc">æ¥æ”¶é‡è¦æ›´æ–°çš„é‚®ä»¶é€šçŸ¥</p>
                                    </div>
                                    <label class="toggle__label">
                                        <input type="checkbox" id="emailNotifications">
                                        <span class="toggle__switch"></span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- å­¦ä¹ è®¡åˆ’ -->
                        <div class="center__section" id="learningPlanSection" style="display: none;">
                            <h3 class="section__title">æˆ‘çš„å­¦ä¹ è®¡åˆ’</h3>
                            <div class="plan__content">
                                <div class="plan__current">
                                    <h4 class="plan__title">å½“å‰ç›®æ ‡</h4>
                                    <div class="plan__progress">
                                        <div class="progress__bar">
                                            <div class="progress__fill" style="width: 60%;"></div>
                                        </div>
                                        <div class="progress__text">å·²å®Œæˆ 12/20 ä¸ªèœè°±</div>
                                    </div>
                                    <div class="plan__actions">
                                        <button class="plan__btn" onclick="setPlan()">è®¾ç½®æ–°ç›®æ ‡</button>
                                        <button class="plan__btn plan__btn--secondary" onclick="viewPlanHistory()">å†å²è®°å½•</button>
                                    </div>
                                </div>
                                
                                <div class="plan__weekly">
                                    <h4 class="plan__title">æœ¬å‘¨å­¦ä¹  <span id="currentWeekRange" class="week-range"></span></h4>
                                    <div class="weekly__grid" id="weeklyGrid">
                                        <!-- æœ¬å‘¨å­¦ä¹ çŠ¶æ€å°†é€šè¿‡JavaScriptæ ¹æ®å®é™…æ—¶é—´åŠ¨æ€ç”Ÿæˆ -->
                                    </div>
                                    <div class="weekly__summary" id="weeklySummary">
                                        <span class="summary__item">
                                            <strong id="completedDaysCount">0</strong> å¤©å·²å­¦ä¹ 
                                        </span>
                                        <span class="summary__item">
                                            <strong id="remainingDaysCount">7</strong> å¤©å¾…å­¦ä¹ 
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- æ¶ˆæ¯ä¸­å¿ƒ -->
                        <div class="center__section" id="messagesSection" style="display: none;">
                            <div class="section__header">
                                <h3 class="section__title">æ¶ˆæ¯ä¸­å¿ƒ</h3>
                                <button class="section__edit-btn" onclick="markAllRead()">
                                    <i class="fas fa-check-double"></i>
                                    å…¨éƒ¨å·²è¯»
                                </button>
                            </div>
                            <div class="messages__list">
                                <div class="message__item unread">
                                    <div class="message__avatar">ğŸ‰</div>
                                    <div class="message__content">
                                        <h4 class="message__title">æ­å–œè§£é”æ–°æˆå°±ï¼</h4>
                                        <p class="message__text">æ‚¨å·²è¿ç»­å­¦ä¹ 7å¤©ï¼Œè·å¾—"çƒ­çˆ±çƒ¹é¥ª"æˆå°±å¾½ç« </p>
                                        <div class="message__time">2å°æ—¶å‰</div>
                                    </div>
                                    <div class="message__actions">
                                        <button class="message__action" onclick="markMessageRead(this)">
                                            <i class="fas fa-check"></i>
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="message__item">
                                    <div class="message__avatar">ğŸ‘¨â€ğŸ³</div>
                                    <div class="message__content">
                                        <h4 class="message__title">æ–°èœè°±æ¨è</h4>
                                        <p class="message__text">æ ¹æ®æ‚¨çš„å–œå¥½ï¼Œä¸ºæ‚¨æ¨èäº†3é“æ–°èœè°±</p>
                                        <div class="message__time">æ˜¨å¤©</div>
                                    </div>
                                    <div class="message__actions">
                                        <button class="message__action" onclick="viewRecommendations()">
                                            <i class="fas fa-external-link-alt"></i>
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="message__item">
                                    <div class="message__avatar">ğŸ’¬</div>
                                    <div class="message__content">
                                        <h4 class="message__title">è®ºå›å›å¤</h4>
                                        <p class="message__text">æœ‰äººåœ¨æ‚¨çš„å¸–å­"æ–°æ‰‹å¦‚ä½•åšå¥½çº¢çƒ§è‚‰"ä¸­å›å¤äº†</p>
                                        <div class="message__time">3å¤©å‰</div>
                                    </div>
                                    <div class="message__actions">
                                        <button class="message__action" onclick="goToForum()">
                                            <i class="fas fa-reply"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- å¸®åŠ©ä¸­å¿ƒ -->
                        <div class="center__section" id="helpSection" style="display: none;">
                            <h3 class="section__title">å¸®åŠ©ä¸­å¿ƒ</h3>
                            <div class="help__content">
                                <div class="help__grid">
                                    <div class="help__card">
                                        <div class="help__icon">â“</div>
                                        <h4 class="help__title">å¸¸è§é—®é¢˜</h4>
                                        <ul class="help__list">
                                            <li><a href="#" class="help__link">å¦‚ä½•æ·»åŠ èœè°±åˆ°æ”¶è—ï¼Ÿ</a></li>
                                            <li><a href="#" class="help__link">å¦‚ä½•ä¿®æ”¹ä¸ªäººä¿¡æ¯ï¼Ÿ</a></li>
                                            <li><a href="#" class="help__link">å¦‚ä½•å‚ä¸è®ºå›è®¨è®ºï¼Ÿ</a></li>
                                            <li><a href="#" class="help__link">å¦‚ä½•è®¾ç½®å­¦ä¹ è®¡åˆ’ï¼Ÿ</a></li>
                                        </ul>
                                    </div>
                                    
                                    <div class="help__card">
                                        <div class="help__icon">ğŸ“</div>
                                        <h4 class="help__title">æ„è§åé¦ˆ</h4>
                                        <form class="feedback__form" id="feedbackForm">
                                            <textarea class="feedback__textarea" placeholder="è¯·å‘Šè¯‰æˆ‘ä»¬æ‚¨çš„å»ºè®®æˆ–é‡åˆ°çš„é—®é¢˜..." rows="4"></textarea>
                                            <div class="feedback__actions">
                                                <button type="submit" class="feedback__submit">
                                                    <i class="fas fa-paper-plane"></i>
                                                    æäº¤åé¦ˆ
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                    
                                    <div class="help__card">
                                        <div class="help__icon">ğŸ“</div>
                                        <h4 class="help__title">è”ç³»æˆ‘ä»¬</h4>
                                        <div class="contact__list">
                                            <div class="contact__item">
                                                <i class="fas fa-envelope"></i>
                                                <span>support@cooking-platform.com</span>
                                            </div>
                                            <div class="contact__item">
                                                <i class="fas fa-phone"></i>
                                                <span>400-123-4567</span>
                                            </div>
                                            <div class="contact__item">
                                                <i class="fas fa-clock"></i>
                                                <span>å·¥ä½œæ—¶é—´ï¼š9:00-18:00</span>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="help__card">
                                        <div class="help__icon">ğŸ“‹</div>
                                        <h4 class="help__title">ä½¿ç”¨æŒ‡å—</h4>
                                        <div class="guide__steps">
                                            <div class="guide__step">
                                                <span class="step__number">1</span>
                                                <span class="step__text">æµè§ˆèœè°±å¤§å…¨</span>
                                            </div>
                                            <div class="guide__step">
                                                <span class="step__number">2</span>
                                                <span class="step__text">æ”¶è—æ„Ÿå…´è¶£çš„èœè°±</span>
                                            </div>
                                            <div class="guide__step">
                                                <span class="step__number">3</span>
                                                <span class="step__text">è·Ÿç€æ­¥éª¤å­¦ä¹ åˆ¶ä½œ</span>
                                            </div>
                                            <div class="guide__step">
                                                <span class="step__number">4</span>
                                                <span class="step__text">åœ¨è®ºå›åˆ†äº«å¿ƒå¾—</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- å¿«æ·æ“ä½œ -->
                        <div class="center__section" id="actionsSection">
                            <h3 class="section__title">å¿«æ·æ“ä½œ</h3>
                            <div class="actions__grid">
                                <a href="../recipes/list.html" class="action__card">
                                    <div class="action__icon">ğŸ”</div>
                                    <div class="action__content">
                                        <h4 class="action__title">æµè§ˆèœè°±</h4>
                                        <p class="action__desc">å‘ç°æ›´å¤šç¾å‘³èœè°±</p>
                                    </div>
                                </a>
                                
                                <a href="favorites.html" class="action__card">
                                    <div class="action__icon">â¤ï¸</div>
                                    <div class="action__content">
                                        <h4 class="action__title">æˆ‘çš„æ”¶è—</h4>
                                        <p class="action__desc">æŸ¥çœ‹æ”¶è—çš„èœè°±</p>
                                    </div>
                                </a>
                                
                                <a href="../forum/index.html" class="action__card">
                                    <div class="action__icon">ğŸ’¬</div>
                                    <div class="action__content">
                                        <h4 class="action__title">ç¾é£Ÿè®ºå›</h4>
                                        <p class="action__desc">ä¸å¨å‹äº¤æµå¿ƒå¾—</p>
                                    </div>
                                </a>
                                
                                <a href="../guide/basics.html" class="action__card">
                                    <div class="action__icon">ğŸ“–</div>
                                    <div class="action__content">
                                        <h4 class="action__title">çƒ¹é¥ªæŒ‡å—</h4>
                                        <p class="action__desc">å­¦ä¹ çƒ¹é¥ªæŠ€å·§</p>
                                    </div>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- é¡µé¢åº•éƒ¨ -->
    <footer class="footer">
        <div class="container">
            <div class="footer__content">
                <div class="footer__section">
                    <h3 class="footer__title">å…³äºæˆ‘ä»¬</h3>
                    <p class="footer__text">
                        ç‚’èœå­¦ä¹ å¹³å°è‡´åŠ›äºä¼ æ’­ä¸­åç¾é£Ÿæ–‡åŒ–ï¼Œè®©æ¯ä¸ªäººéƒ½èƒ½è½»æ¾å­¦ä¼šåšèœã€‚
                    </p>
                </div>
                <div class="footer__section">
                    <h3 class="footer__title">å¿«é€Ÿé“¾æ¥</h3>
                    <ul class="footer__links">
                        <li><a href="../recipes/list.html">èœè°±å¤§å…¨</a></li>
                        <li><a href="../guide/basics.html">çƒ¹é¥ªåŸºç¡€</a></li>
                        <li><a href="../guide/tips.html">çƒ¹é¥ªæŠ€å·§</a></li>
                        <li><a href="../about.html">å…³äºæˆ‘ä»¬</a></li>
                    </ul>
                </div>
                <div class="footer__section">
                    <h3 class="footer__title">è”ç³»æ–¹å¼</h3>
                    <ul class="footer__contact">
                        <li>ğŸ“§ contact@cooking-platform.com</li>
                        <li>ğŸ“± 400-123-4567</li>
                    </ul>
                </div>
            </div>
            <div class="footer__bottom">
                <p>&copy; 2024 ç‚’èœå­¦ä¹ å¹³å°. ä¿ç•™æ‰€æœ‰æƒåˆ©.</p>
            </div>
        </div>
    </footer>

    <!-- JavaScript æ–‡ä»¶ -->
    <script>
        // é¡µé¢åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // æ£€æŸ¥ç™»å½•çŠ¶æ€
            const isLoggedIn = localStorage.getItem('isLoggedIn');
            if (!isLoggedIn) {
                window.location.href = '../../index.html';
                return;
            }
            
            // åˆå§‹åŒ–åŠŸèƒ½
            loadUserInfo();
            initAvatarUpload();
            initProfileEdit();
            updateStats();
            initNavigation();
            initNotificationSettings();
            initSecurityFeatures();
        });
        
        function loadUserInfo() {
            const username = localStorage.getItem('username') || 'ç”¨æˆ·å';
            const email = localStorage.getItem('email') || 'email@example.com';
            const phone = localStorage.getItem('phone') || 'æœªç»‘å®š';
            const bio = localStorage.getItem('bio') || 'çƒ­çˆ±ç¾é£Ÿçš„çƒ¹é¥ªçˆ±å¥½è€…';
            
            // æ›´æ–°æ˜¾ç¤º
            document.getElementById('profileName').textContent = username;
            document.getElementById('profileEmail').textContent = email;
            document.getElementById('displayUsername').textContent = username;
            document.getElementById('displayEmail').textContent = email;
            document.getElementById('displayPhone').textContent = phone;
            document.getElementById('displayBio').textContent = bio;
            
            // æ›´æ–°ç¼–è¾‘è¡¨å•
            document.getElementById('editUsername').value = username;
            document.getElementById('editEmail').value = email;
            document.getElementById('editPhone').value = phone !== 'æœªç»‘å®š' ? phone : '';
            document.getElementById('editBio').value = bio;
        }
        
        function initAvatarUpload() {
            const uploadBtn = document.getElementById('avatarUploadBtn');
            const avatarInput = document.getElementById('avatarInput');
            const avatarImg = document.getElementById('profileAvatar');
            
            uploadBtn.addEventListener('click', function() {
                avatarInput.click();
            });
            
            avatarInput.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file && file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const newAvatar = e.target.result;
                        
                        // æ›´æ–°å½“å‰é¡µé¢çš„å¤´åƒæ˜¾ç¤º
                        avatarImg.src = newAvatar;
                        
                        // ä½¿ç”¨ç”¨æˆ·ç®¡ç†ç³»ç»Ÿæ›´æ–°å¤´åƒï¼Œè¿™ä¼šåŒæ­¥åˆ°æ‰€æœ‰é¡µé¢
                        if (window.userManager) {
                            window.userManager.updateUserInfo({
                                avatar: newAvatar
                            });
                            
                            console.log('å¤´åƒå·²æ›´æ–°å¹¶åŒæ­¥åˆ°æ‰€æœ‰é¡µé¢');
                            
                            // æ˜¾ç¤ºæ›´æ–°æˆåŠŸæç¤º
                            showToast('å¤´åƒæ›´æ–°æˆåŠŸï¼', 'success');
                        } else {
                            // é™çº§å¤„ç†ï¼šå¦‚æœç”¨æˆ·ç®¡ç†ç³»ç»ŸæœªåŠ è½½ï¼Œä½¿ç”¨åŸæ¥çš„æ–¹å¼
                            localStorage.setItem('userAvatar', newAvatar);
                        }
                    };
                    reader.readAsDataURL(file);
                }
            });
            
            // ä»ç”¨æˆ·ç®¡ç†ç³»ç»ŸåŠ è½½å¤´åƒ
            if (window.userManager && window.userManager.isLoggedIn()) {
                const userInfo = window.userManager.getCurrentUser();
                if (userInfo && userInfo.avatar) {
                    avatarImg.src = userInfo.avatar;
                }
            } else {
                // é™çº§å¤„ç†ï¼šä»localStorageåŠ è½½
                const savedAvatar = localStorage.getItem('userAvatar');
                if (savedAvatar) {
                    avatarImg.src = savedAvatar;
                }
            }
        }
        
        // æ˜¾ç¤ºæç¤ºæ¶ˆæ¯
        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.textContent = message;
            toast.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'success' ? '#4caf50' : '#2196f3'};
                color: white;
                padding: 15px 25px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.2);
                z-index: 10000;
                font-size: 14px;
                font-weight: 500;
                opacity: 0;
                transform: translateX(100px);
                transition: all 0.3s ease;
            `;

            document.body.appendChild(toast);

            setTimeout(() => {
                toast.style.opacity = '1';
                toast.style.transform = 'translateX(0)';
            }, 10);

            setTimeout(() => {
                toast.style.opacity = '0';
                toast.style.transform = 'translateX(100px)';
                setTimeout(() => {
                    if (toast.parentNode) {
                        toast.parentNode.removeChild(toast);
                    }
                }, 300);
            }, 3000);
        }
        
        function initProfileEdit() {
            const toggleBtn = document.getElementById('toggleEditMode');
            const viewMode = document.getElementById('profileView');
            const editMode = document.getElementById('profileEdit');
            const editForm = document.getElementById('profileEditForm');
            const cancelBtn = document.getElementById('cancelEditBtn');
            
            toggleBtn.addEventListener('click', function() {
                viewMode.style.display = 'none';
                editMode.style.display = 'block';
                toggleBtn.innerHTML = '<i class="fas fa-eye"></i> æŸ¥çœ‹æ¨¡å¼';
            });
            
            cancelBtn.addEventListener('click', function() {
                editMode.style.display = 'none';
                viewMode.style.display = 'block';
                toggleBtn.innerHTML = '<i class="fas fa-edit"></i> ç¼–è¾‘èµ„æ–™';
                loadUserInfo(); // é‡æ–°åŠ è½½æ•°æ®
            });
            
            editForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                // è·å–è¡¨å•æ•°æ®
                const username = document.getElementById('editUsername').value;
                const email = document.getElementById('editEmail').value;
                const phone = document.getElementById('editPhone').value;
                const bio = document.getElementById('editBio').value;
                
                // ä½¿ç”¨ç”¨æˆ·ç®¡ç†ç³»ç»Ÿæ›´æ–°ç”¨æˆ·ä¿¡æ¯
                if (window.userManager && window.userManager.isLoggedIn()) {
                    window.userManager.updateUserInfo({
                        username: username,
                        email: email
                    });
                    
                    console.log('ç”¨æˆ·ä¿¡æ¯å·²æ›´æ–°å¹¶åŒæ­¥åˆ°æ‰€æœ‰é¡µé¢');
                    showToast('èµ„æ–™ä¿å­˜æˆåŠŸï¼', 'success');
                } else {
                    // é™çº§å¤„ç†ï¼šä¿å­˜åˆ°localStorage
                    localStorage.setItem('username', username);
                    localStorage.setItem('email', email);
                    alert('èµ„æ–™ä¿å­˜æˆåŠŸï¼');
                }
                
                // ä¿å­˜å…¶ä»–ä¿¡æ¯åˆ°localStorageï¼ˆæ‰‹æœºå·ã€ä¸ªäººç®€ä»‹æš‚ä¸é€šè¿‡ç”¨æˆ·ç®¡ç†ç³»ç»ŸåŒæ­¥ï¼‰
                localStorage.setItem('phone', phone || 'æœªç»‘å®š');
                localStorage.setItem('bio', bio);
                
                // æ›´æ–°æ˜¾ç¤º
                loadUserInfo();
                
                // åˆ‡æ¢å›æŸ¥çœ‹æ¨¡å¼
                editMode.style.display = 'none';
                viewMode.style.display = 'block';
                toggleBtn.innerHTML = '<i class="fas fa-edit"></i> ç¼–è¾‘èµ„æ–™';
            });
        }
        
        function updateStats() {
            // ä½¿ç”¨ç”¨æˆ·ä¸­å¿ƒç®¡ç†ç³»ç»Ÿæ›´æ–°ç»Ÿè®¡
            if (window.userCenterManager) {
                window.userCenterManager.updateStats();
                window.userCenterManager.renderRecentLearning();
                window.userCenterManager.renderWeeklyLearning();
            } else {
                // é™çº§å¤„ç†
                const favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
                document.getElementById('favoriteCount').textContent = favorites.length;
                
                const learnedRecipes = localStorage.getItem('learnedRecipes') || '12';
                document.getElementById('learnedRecipes').textContent = learnedRecipes;
                
                const studyDays = localStorage.getItem('studyDays') || '15';
                document.getElementById('studyDays').textContent = studyDays;
                
                const achievements = localStorage.getItem('achievements') || '3';
                document.getElementById('achievements').textContent = achievements;
            }
        }
        
        // æ•°æ®ç®¡ç†å‡½æ•°
        function syncLearningData() {
            // æ¨¡æ‹Ÿæ•°æ®åŒæ­¥
            alert('å­¦ä¹ æ•°æ®åŒæ­¥ä¸­...');
            setTimeout(() => {
                updateStats();
                alert('æ•°æ®åŒæ­¥å®Œæˆï¼');
            }, 1000);
        }
        
        function exportFavorites() {
            const favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
            const dataStr = JSON.stringify(favorites, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = `æˆ‘çš„æ”¶è—_${new Date().toISOString().split('T')[0]}.json`;
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
        }
        
        function clearFavorites() {
            if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰æ”¶è—å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ï¼')) {
                localStorage.removeItem('favorites');
                updateStats();
                alert('æ”¶è—å·²æ¸…ç©ºï¼');
            }
        }
        
        function backupAllData() {
            const allData = {
                username: localStorage.getItem('username'),
                email: localStorage.getItem('email'),
                phone: localStorage.getItem('phone'),
                bio: localStorage.getItem('bio'),
                favorites: JSON.parse(localStorage.getItem('favorites') || '[]'),
                learnedRecipes: localStorage.getItem('learnedRecipes'),
                studyDays: localStorage.getItem('studyDays'),
                achievements: localStorage.getItem('achievements'),
                userAvatar: localStorage.getItem('userAvatar'),
                backupDate: new Date().toISOString()
            };
            
            const dataStr = JSON.stringify(allData, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = `ç‚’èœå¹³å°æ•°æ®å¤‡ä»½_${new Date().toISOString().split('T')[0]}.json`;
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
            
            alert('æ•°æ®å¤‡ä»½å·²ä¸‹è½½ï¼');
        }
        
        // å¯¼èˆªåˆ‡æ¢åŠŸèƒ½
        function initNavigation() {
            const navItems = document.querySelectorAll('[data-section]');
            const sections = document.querySelectorAll('.center__section');
            
            navItems.forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    const targetSection = this.getAttribute('data-section');
                    
                    // ç§»é™¤æ‰€æœ‰æ´»åŠ¨çŠ¶æ€
                    navItems.forEach(nav => nav.classList.remove('center__nav-item--active'));
                    sections.forEach(section => section.style.display = 'none');
                    
                    // è®¾ç½®å½“å‰é¡¹ç›®ä¸ºæ´»åŠ¨çŠ¶æ€
                    this.classList.add('center__nav-item--active');
                    
                    // æ˜¾ç¤ºå¯¹åº”çš„å†…å®¹åŒºåŸŸ
                    if (targetSection === 'profile') {
                        document.getElementById('profileSection').style.display = 'block';
                    } else if (targetSection === 'learning') {
                        document.getElementById('learningSection').style.display = 'block';
                        document.getElementById('achievementsSection').style.display = 'block';
                        document.getElementById('learningPlanSection').style.display = 'block';
                    } else if (targetSection === 'security') {
                        document.getElementById('securitySection').style.display = 'block';
                    } else if (targetSection === 'notifications') {
                        document.getElementById('notificationsSection').style.display = 'block';
                    } else if (targetSection === 'help') {
                        document.getElementById('helpSection').style.display = 'block';
                    }
                });
            });
        }
        
        // é€šçŸ¥è®¾ç½®åŠŸèƒ½
        function initNotificationSettings() {
            const checkboxes = document.querySelectorAll('#notificationsSection input[type="checkbox"]');
            
            // åŠ è½½ä¿å­˜çš„è®¾ç½®
            checkboxes.forEach(checkbox => {
                const saved = localStorage.getItem(checkbox.id);
                if (saved !== null) {
                    checkbox.checked = saved === 'true';
                }
                
                // ç›‘å¬å˜åŒ–
                checkbox.addEventListener('change', function() {
                    localStorage.setItem(this.id, this.checked);
                });
            });
        }
        
        // å®‰å…¨åŠŸèƒ½
        function initSecurityFeatures() {
            const twoFactorToggle = document.getElementById('twoFactorToggle');
            if (twoFactorToggle) {
                const saved = localStorage.getItem('twoFactorEnabled');
                twoFactorToggle.checked = saved === 'true';
                
                twoFactorToggle.addEventListener('change', function() {
                    localStorage.setItem('twoFactorEnabled', this.checked);
                    if (this.checked) {
                        alert('äºŒæ­¥éªŒè¯å·²å¯ç”¨ï¼');
                    } else {
                        alert('äºŒæ­¥éªŒè¯å·²å…³é—­ï¼');
                    }
                });
            }
        }
        
        // å®‰å…¨åŠŸèƒ½å‡½æ•°
        function showPasswordModal() {
            const newPassword = prompt('è¯·è¾“å…¥æ–°å¯†ç :');
            if (newPassword && newPassword.length >= 6) {
                localStorage.setItem('userPassword', newPassword);
                alert('å¯†ç ä¿®æ”¹æˆåŠŸï¼');
            } else if (newPassword) {
                alert('å¯†ç é•¿åº¦è‡³å°‘éœ€è¦6ä½å­—ç¬¦ï¼');
            }
        }
        
        function showDevices() {
            alert('å½“å‰ç™»å½•è®¾å¤‡ï¼š\n1. Chromeæµè§ˆå™¨ (å½“å‰è®¾å¤‡)\næœ€åæ´»è·ƒï¼šåˆšåˆš');
        }
        
        // æ¶ˆæ¯ä¸­å¿ƒåŠŸèƒ½
        function markAllRead() {
            const unreadMessages = document.querySelectorAll('.message__item.unread');
            unreadMessages.forEach(msg => {
                msg.classList.remove('unread');
            });
            alert('æ‰€æœ‰æ¶ˆæ¯å·²æ ‡è®°ä¸ºå·²è¯»ï¼');
        }
        
        function markMessageRead(button) {
            const messageItem = button.closest('.message__item');
            messageItem.classList.remove('unread');
        }
        
        function viewRecommendations() {
            window.location.href = '../recipes/list.html';
        }
        
        function goToForum() {
            window.location.href = '../forum/index.html';
        }
        
        // å­¦ä¹ è®¡åˆ’åŠŸèƒ½
        function setPlan() {
            const target = prompt('è¯·è®¾ç½®æ‚¨çš„å­¦ä¹ ç›®æ ‡ï¼ˆèœè°±æ•°é‡ï¼‰:', '20');
            if (target && !isNaN(target)) {
                localStorage.setItem('learningTarget', target);
                alert(`å­¦ä¹ ç›®æ ‡å·²è®¾ç½®ä¸º ${target} ä¸ªèœè°±ï¼`);
            }
        }
        
        function viewPlanHistory() {
            alert('å­¦ä¹ å†å²ï¼š\næœ¬æœˆå·²å­¦ä¹ 12ä¸ªèœè°±\nä¸Šæœˆå­¦ä¹ 8ä¸ªèœè°±\nè¿ç»­å­¦ä¹ 15å¤©');
        }
        
        // åé¦ˆè¡¨å•
        document.getElementById('feedbackForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const feedback = this.querySelector('.feedback__textarea').value;
            if (feedback.trim()) {
                // æ¨¡æ‹Ÿæäº¤åé¦ˆ
                alert('æ„Ÿè°¢æ‚¨çš„åé¦ˆï¼æˆ‘ä»¬ä¼šè®¤çœŸè€ƒè™‘æ‚¨çš„å»ºè®®ã€‚');
                this.reset();
            } else {
                alert('è¯·å¡«å†™åé¦ˆå†…å®¹ï¼');
            }
        });
    </script>
    <!-- JavaScript æ–‡ä»¶ -->
    <script src="../../js/utils/storage.js"></script>
    <script src="../../js/utils/dom.js"></script>
    <script src="../../js/utils/api.js"></script>
    <script src="../../js/data/recipes.js"></script>
    <script src="../../js/data/categories.js"></script>
    <script src="../../js/utils/user-manager.js"></script>
    <script src="../../js/utils/user-center-manager.js"></script>
    <script src="../../js/components/header.js"></script>
    <script src="../../js/app.js"></script>
</body>
</html>
